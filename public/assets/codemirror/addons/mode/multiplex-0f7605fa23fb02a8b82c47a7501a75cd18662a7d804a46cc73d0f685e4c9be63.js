// CodeMirror, copyright (c) by Marijn Haverbeke and others
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.multiplexingMode=function(n){function i(e,n,i,t){if("string"==typeof n){var r=e.indexOf(n,i);return t&&r>-1?r+n.length:r}var o=n.exec(i?e.slice(i):e);return o?o.index+i+(t?o[0].length:0):-1}var t=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:e.startState(n),innerActive:null,inner:null}},copyState:function(i){return{outer:e.copyState(n,i.outer),innerActive:i.innerActive,inner:i.innerActive&&e.copyState(i.innerActive.mode,i.inner)}},token:function(r,o){if(o.innerActive){var c=o.innerActive;u=r.string;if(!c.close&&r.sol())return o.innerActive=o.inner=null,this.token(r,o);if((d=c.close?i(u,c.close,r.pos,c.parseDelimiters):-1)==r.pos&&!c.parseDelimiters)return r.match(c.close),o.innerActive=o.inner=null,c.delimStyle&&c.delimStyle+" "+c.delimStyle+"-close";d>-1&&(r.string=u.slice(0,d));var l=c.mode.token(r,o.inner);return d>-1&&(r.string=u),d==r.pos&&c.parseDelimiters&&(o.innerActive=o.inner=null),c.innerStyle&&(l=l?l+" "+c.innerStyle:c.innerStyle),l}for(var s=Infinity,u=r.string,a=0;a<t.length;++a){var d,v=t[a];if((d=i(u,v.open,r.pos))==r.pos)return v.parseDelimiters||r.match(v.open),o.innerActive=v,o.inner=e.startState(v.mode,n.indent?n.indent(o.outer,""):0),v.delimStyle&&v.delimStyle+" "+v.delimStyle+"-open";-1!=d&&d<s&&(s=d)}s!=Infinity&&(r.string=u.slice(0,s));var f=n.token(r,o.outer);return s!=Infinity&&(r.string=u),f},indent:function(i,t){var r=i.innerActive?i.innerActive.mode:n;return r.indent?r.indent(i.innerActive?i.inner:i.outer,t):e.Pass},blankLine:function(i){var r=i.innerActive?i.innerActive.mode:n;if(r.blankLine&&r.blankLine(i.innerActive?i.inner:i.outer),i.innerActive)"\n"===i.innerActive.close&&(i.innerActive=i.inner=null);else for(var o=0;o<t.length;++o){var c=t[o];"\n"===c.open&&(i.innerActive=c,i.inner=e.startState(c.mode,r.indent?r.indent(i.outer,""):0))}},electricChars:n.electricChars,innerMode:function(e){return e.inner?{state:e.inner,mode:e.innerActive.mode}:{state:e.outer,mode:n}}}}});